<!--{% assign url_parts = page.url | split: '/' %}
{% assign url_parts_size = url_parts | size %}

{% assign rm = url_parts | last %}
{% assign base_url = page.url | replace: rm %}

{% capture location %}{{ page.url | split:'/' }}{% endcapture %}

<nav class="wrapper">
  <ul>
    {% for node in site.pages %}
    {% assign current = page.title | downcase %}
      {% if node.url %}

      {% assign node_url_parts = node.url | split: '/' %}
        {% assign node_url_parts_size = node_url_parts | size %}
        {% assign filename = node_url_parts | last %}
        {% if url_parts_size == node_url_parts_size and filename != 'index.html' %}

          {% if page.title %}
          <li {% if location == current %} class="current" {% endif %}>
            <a href="{{ node.url | prepend: site.baseurl }}">{{node.title}}</a>
          </li>
          {% endif %}

        {% endif %}
      {% endif %}
    {% endfor %}
  </ul>
</nav>-->

{% capture html %}
<ul class="TEST">
  {% if include.context == "/" %}
  <li class="{% if page.url == "/" %}active{% endif %}">
  <a href="{{ site.baseurl }}/">{{ site.title }}</a>
  </li>
  {% endif %}

  {% assign entries = site.pages | sort: "path" %}
  {% for entry in entries %}

  {% capture slug    %}{{ entry.url | split: "/"   | last                       }}{% endcapture %}
  {% capture current %}{{ entry.url | remove: slug | remove: "//" | append: "/" }}{% endcapture %}

  {% if current == include.context %}
  <li class="{% if page.url contains entry.url %}active{% endif %}">
    <a href="{{ site.baseurl }}{{ entry.url }}">{{ entry.title }}</a>
    {% include navigation.html context=entry.url %}
  </li>
  {% endif %}

  {% endfor %}
</ul>
{% endcapture %}{{ html | strip_newlines | replace:'    ','' | replace:'    ','' | replace:'  ',' ' }}


